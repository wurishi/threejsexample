var L=Object.defineProperty;var w=(r,s,t)=>s in r?L(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t;var l=(r,s,t)=>(w(r,typeof s!="symbol"?s+"":s,t),t);import{E as y,aL as T,D as F,b as G,ak as S,al as I,aR as W,A as b,aS as M}from"./example-e9f3c815.js";import{G as O}from"./index-ba66c6be.js";import{G as k}from"./GLTFLoader-27d86567.js";class H extends y{constructor(){super(...arguments);l(this,"model");l(this,"actions",{});l(this,"previousAction");l(this,"activeAction");l(this,"fadeToAction",(t,d)=>{var i,o;this.previousAction=this.activeAction,this.activeAction=this.actions[t],this.previousAction!==this.activeAction&&((i=this.previousAction)==null||i.fadeOut(d)),(o=this.activeAction)==null||o.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(d).play()})}init(t){super.init(t);const d=this.utils.createPerspectiveCamera({near:.25},[-5,3,10],[0,2,0]);this.camera=d;const i=this.utils.createScene(14737632,[14737632,20,100]);this.scene=i;const o=new T(16777215,4473924);o.position.set(0,20,0),i.add(o);const n=new F(16777215);n.position.set(0,20,10),i.add(n);const m=new G(new S(2e3,2e3),new I({color:10066329,depthWrite:!1}));m.rotation.x=-Math.PI/2,i.add(m);const p=new W(200,40,0,0),a=p.material;a.opacity=.2,a.transparent=!0,i.add(p);let h;return new k().load("assets/models/gltf/RobotExpressive.glb",f=>{const g=f.scene;i.add(g),this.model=g,h=this.createGUI(t.ui,f.animations)}),()=>{h&&h()}}createGUI(t,d){var A;const i=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],o=["Jump","Yes","No","Wave","Punch","ThumbsUp"],n=new O;t.appendChild(n.domElement.parentElement);const m=new b(this.model);this.mixer=m;const p=this.actions;d.forEach(e=>{const c=m.clipAction(e);p[e.name]=c,(o.indexOf(e.name)>=0||i.indexOf(e.name)>=4)&&(c.clampWhenFinished=!0,c.loop=M)});const a={state:"Walking"},h=n.addFolder("States");h.add(a,"state").options(i).onChange(()=>{this.fadeToAction(a.state,.5)}),h.open();const f=n.addFolder("Emotes"),g=()=>{var e;(e=this.mixer)==null||e.removeEventListener("finished",g),this.fadeToAction(a.state,.2)};o.forEach(e=>{a[e]=()=>{var c;this.fadeToAction(e,.2),(c=this.mixer)==null||c.addEventListener("finished",g)},f.add(a,e)}),f.open();const u=(A=this.model)==null?void 0:A.getObjectByName("Head_4"),E=Object.keys(u.morphTargetDictionary),v=n.addFolder("Expressions");return E.forEach((e,c)=>{v.add(u.morphTargetInfluences,c.toString(),0,1,.01).name(e)}),this.activeAction=p.Walking,this.activeAction.play(),v.open(),()=>{n.destroy()}}}export{H as default};
